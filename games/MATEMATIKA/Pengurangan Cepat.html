<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis Pengurangan Cepat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap');
        body { font-family: 'Fredoka', sans-serif; background: #fff1f2; display: flex; align-items: center; justify-content: center; min-height: 100vh; margin: 0; }
        .card { background: white; border-radius: 2rem; box-shadow: 0 20px 50px rgba(225, 29, 72, 0.1); width: 100%; max-width: 420px; padding: 2rem; position: relative; }
        .input-box { border: 2px solid #ffe4e6; border-radius: 1rem; padding: 0.5rem; width: 100%; font-weight: bold; color: #be123c; text-align: center; outline: none; transition: all 0.2s; }
        .input-box:focus { border-color: #fb7185; background: #fff1f2; }
        .option-btn { background: #fff1f2; border: 2px solid #fecdd3; color: #9f1239; font-size: 1.5rem; font-weight: 800; padding: 1.2rem; border-radius: 1.25rem; cursor: pointer; transition: 0.2s; }
        .option-btn:hover:not(:disabled) { transform: translateY(-4px); background: #f43f5e; color: white; border-color: #f43f5e; box-shadow: 0 8px 15px rgba(244, 63, 94, 0.2); }
        .option-btn.correct { background: #10b981 !important; border-color: #059669 !important; color: white !important; }
        .option-btn.wrong { background: #ef4444 !important; border-color: #b91c1c !important; color: white !important; }
        .timer-bar { height: 10px; background: #f3f4f6; border-radius: 5px; margin-bottom: 2rem; overflow: hidden; border: 2px solid white; }
        .timer-fill { height: 100%; background: linear-gradient(to right, #fb7185, #f43f5e); width: 100%; transition: width 1s linear; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div id="setup-screen" class="card text-center shadow-2xl">
        <div class="mb-4 text-5xl">‚ö°</div>
        <h1 class="text-2xl font-black text-rose-600 mb-2 uppercase tracking-tighter">Pengurangan Cepat</h1>
        <p class="text-slate-400 text-sm mb-6">Atur rentang angka tantanganmu!</p>

        <div class="space-y-4 mb-8">
            <div class="bg-rose-50 p-4 rounded-2xl border border-rose-100">
                <span class="block text-[10px] font-black text-rose-400 mb-2 uppercase tracking-widest">Rentang Angka A (Depan)</span>
                <div class="grid grid-cols-2 gap-3">
                    <input type="number" id="min-a" value="5" class="input-box" placeholder="Min">
                    <input type="number" id="max-a" value="15" class="input-box" placeholder="Max">
                </div>
            </div>
            <div class="bg-blue-50 p-4 rounded-2xl border border-blue-100">
                <span class="block text-[10px] font-black text-blue-400 mb-2 uppercase tracking-widest">Rentang Angka B (Belakang)</span>
                <div class="grid grid-cols-2 gap-3">
                    <input type="number" id="min-b" value="1" class="input-box" placeholder="Min">
                    <input type="number" id="max-b" value="5" class="input-box" placeholder="Max">
                </div>
            </div>
            <div class="grid grid-cols-2 gap-3">
                <div>
                    <span class="block text-[10px] font-bold text-slate-400 mb-1 uppercase">Waktu (Detik)</span>
                    <input type="number" id="timer-val" value="5" class="input-box">
                </div>
                <div>
                    <span class="block text-[10px] font-bold text-slate-400 mb-1 uppercase">Jml Soal</span>
                    <input type="number" id="total-q" value="10" class="input-box">
                </div>
            </div>
        </div>

        <button onclick="startGame()" class="w-full bg-rose-600 text-white font-black py-5 rounded-2xl shadow-lg shadow-rose-200 active:scale-95 transition-all text-lg">
            MULAI SEKARANG üöÄ
        </button>
    </div>

    <div id="game-screen" class="card hidden text-center">
        <div class="flex justify-between items-center mb-4">
            <span class="bg-slate-100 text-slate-500 px-4 py-1 rounded-full text-[10px] font-black uppercase">Soal <span id="cur-idx">1</span> / <span id="max-idx">10</span></span>
            <span class="text-rose-500 font-black">Skor: <span id="live-score">0</span></span>
        </div>
        <div class="timer-bar"><div id="timer-fill" class="timer-fill"></div></div>
        <div class="py-10">
            <div id="equation" class="text-7xl font-black text-slate-800 tracking-tighter">0 - 0</div>
            <div id="feedback" class="h-8 mt-4 font-black text-2xl uppercase tracking-widest"></div>
        </div>
        <div id="options-grid" class="grid grid-cols-2 gap-4"></div>
    </div>

    <div id="result-screen" class="hidden card text-center">
        <div class="text-6xl mb-4">üèÜ</div>
        <h2 class="text-3xl font-black text-slate-800 mb-2">Selesai!</h2>
        <p class="text-slate-400 font-bold mb-8 uppercase tracking-widest text-xs">Skor Akhir Anda</p>
        <div class="bg-rose-50 rounded-[2.5rem] p-10 mb-8 border-2 border-rose-100">
            <div id="final-score" class="text-9xl font-black text-rose-600 leading-none">0</div>
            <div class="text-rose-300 font-black mt-4 text-xl tracking-widest uppercase">Poin</div>
        </div>
        <button onclick="location.reload()" class="w-full bg-slate-800 text-white font-black py-5 rounded-2xl text-xl hover:bg-black transition-all">MAIN LAGI ‚Ü∫</button>
    </div>

    <script>
        let cfg = { minA:5, maxA:15, minB:1, maxB:5, time:5, total:10 };
        let game = { cur:1, score:0, time:0, inv:null, can:true, ans:0 };

        function startGame() {
            cfg.minA = parseInt(document.getElementById('min-a').value) || 1;
            cfg.maxA = parseInt(document.getElementById('max-a').value) || 10;
            cfg.minB = parseInt(document.getElementById('min-b').value) || 1;
            cfg.maxB = parseInt(document.getElementById('max-b').value) || 10;
            cfg.time = parseInt(document.getElementById('timer-val').value) || 5;
            cfg.total = parseInt(document.getElementById('total-q').value) || 10;

            if(cfg.minA > cfg.maxA || cfg.minB > cfg.maxB) {
                alert("Nilai Minimal tidak boleh lebih besar dari Maksimal!");
                return;
            }

            document.getElementById('max-idx').textContent = cfg.total;
            document.getElementById('setup-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            loadQuestion();
        }

        function loadQuestion() {
            if (game.cur > cfg.total) return finish();
            game.can = true;
            document.getElementById('feedback').textContent = "";
            document.getElementById('cur-idx').textContent = game.cur;
            
            // Logika Pengurangan: A - B (A harus >= B)
            let b = Math.floor(Math.random() * (cfg.maxB - cfg.minB + 1)) + cfg.minB;
            // Pastikan nilai minimal A yang diacak minimal sebesar b agar hasil tidak negatif
            let actualMinA = Math.max(cfg.minA, b); 
            let a = Math.floor(Math.random() * (cfg.maxA - actualMinA + 1)) + actualMinA;
            
            // Jika setting user memaksa hasil negatif (Misal Max A = 5, Min B = 10), kita tukar
            if (a < b) { let temp = a; a = b; b = temp; }

            game.ans = a - b;
            document.getElementById('equation').textContent = `${a} - ${b}`;
            
            // Generate Pilihan (Setiap angka unik)
            let opts = new Set([game.ans]);
            while(opts.size < 4) {
                let dev = Math.floor(Math.random() * 9) - 4; // -4 s/d +4
                let wrong = game.ans + dev;
                if(wrong >= 0 && !opts.has(wrong)) opts.add(wrong);
                if(opts.size < 4 && dev > 10) opts.add(game.ans + opts.size + 1); // Safety break
            }
            
            const grid = document.getElementById('options-grid');
            grid.innerHTML = '';
            Array.from(opts).sort(() => Math.random() - 0.5).forEach(val => {
                const btn = document.createElement('button');
                btn.textContent = val;
                btn.className = "option-btn";
                btn.onclick = () => checkAns(val, btn);
                grid.appendChild(btn);
            });
            runTimer();
        }

        function runTimer() {
            clearInterval(game.inv);
            game.time = cfg.time;
            const bar = document.getElementById('timer-fill');
            bar.style.transition = 'none';
            bar.style.width = '100%';
            setTimeout(() => {
                bar.style.transition = `width ${cfg.time}s linear`;
                bar.style.width = '0%';
            }, 50);

            game.inv = setInterval(() => {
                game.time -= 1;
                if (game.time < 0) { clearInterval(game.inv); checkAns(null); }
            }, 1000);
        }

        function checkAns(val, btn) {
            if (!game.can) return;
            game.can = false;
            clearInterval(game.inv);
            const fb = document.getElementById('feedback');

            if (val === game.ans) {
                game.score++;
                document.getElementById('live-score').textContent = game.score;
                fb.textContent = "BENAR! ‚ú®";
                fb.className = "h-8 mt-4 font-black text-2xl text-green-500 uppercase";
                if(btn) btn.classList.add('correct');
            } else {
                fb.textContent = val === null ? "WAKTU HABIS!" : "SALAH! ‚ùå";
                fb.className = "h-8 mt-4 font-black text-2xl text-red-500 uppercase";
                if(btn) btn.classList.add('wrong');
                // Tunjukkan jawaban benar
                document.querySelectorAll('.option-btn').forEach(b => {
                    if(parseInt(b.textContent) === game.ans) b.classList.add('correct');
                });
            }

            setTimeout(() => { game.cur++; loadQuestion(); }, 1200);
        }

        function finish() {
            document.getElementById('game-screen').classList.add('hidden');
            const final = Math.round((game.score / cfg.total) * 100);
            document.getElementById('final-score').textContent = final;
            document.getElementById('result-screen').classList.remove('hidden');
        }
    </script>
</body>
</html>
